---
typora-copy-images-to: mdImg
---

# 学习目标

> - [ ] 能够使用ducment.createElement方法创建元素
> - [ ] 能够说出注册事件的两种方式
> - [ ] 能够说出事件流的三个阶段
> - [ ] 能够获取事件对象
> - [ ] 能够说出pageX、clientX、screenX的区别
> - [ ] 能够获取键盘事件的键盘码
>
> 。。。。。。



**理解上课的知识点......**



# 节点操作

## 创建节点（3种方式）

**需求：** 点击按钮之后，可以在div内部生成一个h1标签



#### document.write()——几乎不用

> document.write() 可以在document网页中生成新节点，但是一般不用

**缺点：**

- 只能在文档页面中生成，不能指定生成在特定位置

- 如果在网页加载完毕之后再设置document.write()写入内容，此时会把之前的页面内容覆盖掉

  > 原因（拓展）：
  >
  > 页面从上往下加载的时候，会开启一个文档流，当页面加载完，文档流就会关闭。
  >
  > document.write() 就是在文档流上写入内容。
  >
  > - 如果页面没加载完成，文档流还开着，此时document.write() 直接在当前文档流上写内容
  > - 如果页面已经加载完成了，文档流已经关闭，此时document.write() 会重新开启一个新的文档流写内容，那么旧的文档流已经被覆盖

---



#### innerHTML——慎用

> innerHTML也可以创建节点

**缺点：**

- 如果原来标签中原来有内容，此时会覆盖原先内容。

- 如果执行多次innerHTML的时候，此时容易出现效率问题。

---



#### createElement——推荐使用

> 在内存中创建一个元素节点，一般配合appendChild()方法一起使用

**语法：** `document.creatElement('tagName')`

**作用：** 在内存中创建一个元素节点

**参数：**

- tagName：需要生成标签的标签名

**返回值：**

- 创建好的标签

---



##### ヾ(๑╹◡╹)ﾉ"  动态创建新闻案例

> 现在需要通过js的方式，当点击按钮之后，在div中动态生成相关的列表

<img src="mdImg/动态创建新闻案例.gif" alt="动态创建新闻案例" style="zoom:80%;" />

- 给button注册事件，点击之后在创建ul标签并且添加到div中去
- 在ul中添加li标签，并且li标签的个数由新闻数组中的数据个数决定

##### ------------------------

##### ヾ(๑╹◡╹)ﾉ"  微博发布的案例

> 用户输入内容后，点击发布后，创建出一个有用户输入内容的li标签

<img src="mdImg/微博发布案例.gif" alt="微博发布案例" style="zoom:80%;" />

- 找对象、给发布button注册事件

- 拿到用户输入的数据（通过trim去除两边的空格），拿到的同时清空textarea中的数据

- 创建出一个li标签，往其中添加用户输入的内容

- 把创建好的li标签添加当ul中去

  > 优化：应该每次li都是添加到ul的最上，使用insertBefore更好

- 创建出一个button标签，设置其中的内容为'删除'

- 把创建好的button添加到li中去

- 让删除button靠右，给删除button设置fr类名

- 给删除button注册事件，点击会后删除当前这个li标签

- 解决小bug：如果用户没有输入，应该alert提醒用户输入，并且结束整个事件函数（return）



## querySelectorAll和children的区别

> 目前我们需要获取子元素，可以通过querySelectorAll或者children都能完成
>
> children会动态更新数据，而querySelectorAll则不会

**需求：先通过querySelectorAll和children获取所有li，然后点击按钮完成在ul中添加一个li，查看之前拿到的li个数变化**

- querySelectorAll：获取的元素集合是静态集合——》拿到数据之后就不管之后的变化了
- children：获取到的元素是动态集合——》拿到数据之后还会动态更新数据

##### ------------------------

# 注册事件的两种方式

**需求：** 现在需要给同一个button，注册两个点击事件，怎么做？

> 多人合作开发的时候可能会遇到类似的场景。

## on+事件名称

> 类似于：onclick。这种方式注册事件几乎所有的浏览器都支持。

**语法：**

```js
// 注册事件-------------------------
box.onclick = function(){
	// 事件处理程序	
}

// 移除事件-------------------------
box.onclick = null;	
```

**优点：** 方便

**缺点：**

- 同一个元素上同时只能注册一个同类型事件，如果同时注册了多个同类型事件，后面的会覆盖前面的

  > 其实就是类似于赋值，后面赋值把前面赋值的覆盖了

---



## addEventListener('事件名称',fn)

> 使用 `on+事件名称` 的方式会有覆盖的问题
>
> 但是 `addEventListener()` 的方式则不会覆盖，并且现代浏览器都支持（不过IE678不支持）

**语法：**

**注册事件：addEventListener**

```javascript
// 第一个参数：事件的类型：click 、 mouseover  
// 第二个参数：事件处理程序
// 第三个参数：事件的阶段（是否捕获），默认为false表示冒泡阶段，true表示捕获阶段
事件源.addEventListener(type,func,useCapture);

// 例子：-------------------------------------
function fn() {
    alert("哈哈哈");
}
//注意点：如果想让注册的事件之后能移除，不能用匿名函数。
box.addEventListener("click", fn, false);
```



# 移除事件的两种方式

> 除了可以给元素注册事件之外，还可以移除元素身上原有的事件

**需求：给button注册事件，然后通过代码移除事件**



## on+事件名=null

> 对于on注册的事件，直接把之前的事件覆盖即可

```js
btn.onclick = null;
```



## removeEventListener('事件名称'，函数名)

> 对于addEventListener注册的事件，需要使用特定的方法移除

```javascript
// 第一个参数：事件的类型
// 第二个参数：要移除的函数名
// 第三个参数：事件的阶段（是否捕获），默认为false表示冒泡阶段，true表示捕获阶段
removeEventListener(type, func, useCapture);
```

**注意点：**如果想要让你注册的事件之后能够移除，不能使用匿名函数。要声明一个有名字的函数使用才行。

---



## attachEvent与detachEvent（了解）

> IE678不支持addEventListener与removeEventListen两个方法，但是支持attachEvent与detachEvnet

**语法：**

**注册事件：attachEvent**

```javascript
// 第一个参数：事件的类型，必须加on，onclick、onmouseover
// 第二个参数：事件处理程序
事件源.attachEvent(type, func)
```

**移出事件：detachEvent**

```javascript
// 第一个参数：事件的类型，必须加on，onclick、onmouseover
// 第二个参数：要移除的函数名
事件源.detachEvent(type, func)
```



##### ------------------------

# 事件流

> 事件冒泡和捕获是实际存在的现象，需要知道。
>
> 通过事件流可以得知事件执行的顺序。



## 事件冒泡

> 当一个元素的事件被触发时，同样的事件将会在该元素的所有祖先元素由内而外中依次被触发。这一过程被称为事件冒泡。

**需求：给父子元素都注册点击事件，点击子元素看效果** 

> 其实点击了子元素就相当于点击了父元素，之间存在事件冒泡的流程

**说白了就是：当我们触发了子元素的某个事件后，父元素对应的事件也会在之后触发** 

![事件冒泡](mdImg/事件冒泡-1587311889376.png)

**注意点：事件冒泡默认会一直往上冒泡，不管父元素中有没有同类型的事件处理函数可以触发。**

- 父元素有同类型事件：触发
- 父元素没有同类型事件：没的触发，浏览器会继续往上冒泡不会停止，直到结束。

---



## 事件捕获（了解）

> 事件捕获是火狐浏览器提出来的，IE678不支持事件捕获（基本上我们使用的都是事件冒泡）
>
> 当一个元素的事件被触发时，同样的事件将会在该元素的所有祖先元素由外而内依次被触发。这一过程被称为事件捕获。

![事件捕获](mdImg/事件捕获.png)

**在后续开发中，我们需要控制父元素的事件是在捕获阶段还是冒泡阶段触发的。此时我们就可以通过控制addEventListener的第三个参数设置事件在什么阶段触发。**



## 事件的三个阶段

> 任何事件都会有三个阶段

1. 事件的**捕获阶段**
2. 事件的**目标阶段**（触发自己的事件）
3. 事件的**冒泡阶段**

 ![three](mdImg/three.png)

**需求：给父子元素通过addEventListener注册点击事件，更改第三个参数演示不同阶段触发**

**注意点：**

- 事件有三个阶段

  - 捕获阶段
  - 目标阶段
  - 冒泡阶段

- 如果是addEventListener，可以通过第三个参数控制事件在什么阶段触发

  > 一般都是冒泡阶段触发，所以第三个参数一般不设置

  - false：默认值，冒泡阶段触发
  - true：捕获阶段触发

- 如果是on注册的事件，默认只在冒泡阶段触发

---



# 事件对象

> 例如：完成小天使跟随鼠标移动，设置图片的位置简单，但是我们需要知道鼠标的位置在哪，这时候可以通过事件对象获取。

## 事件对象的概述

> 任何一个事件触发时都会有一个事件对象，这个对象中包含所有与事件相关的一些信息，包括事件源、事件类型、鼠标位置、键盘信息等等

**常见情况：**

- 鼠标事件触发时，事件对象中会包含鼠标的位置信息
- 键盘事件触发时，事件对象中会包含按下的键相关的信息

> 不管开发中用没用到事件对象，每一个事件触发时都会有一个事件对象（你用不用，它都在那里）



## 获取事件对象

> 既然事件对象中包含事件相关的信息，我们想要用就需要先获取到。

对于现代浏览器，获取事件对象非常的简单，只需要在注册事件的时候，指定一个形参即可。这个形参就是我们想要获取到的事件对象。

```javascript
btn.onclick = function(event){
    //event就是事件对象，里面包含了事件触发时的一些信息。
	console.log(event);
}
// --------------------------------
btn.addEventListener('click',function (event) {
    //event就是事件对象，里面包含了事件触发时的一些信息。
    console.log( event );
});
```

##### ヾ(๑╹◡╹)ﾉ" 演示获取点击事件的事件对象

---



## 事件对象的常用属性

> 事件对象中包含有很多的属性，但是实际开发的时候只需要记住几个常用的即可

### 鼠标事件对象的属性

> 有些事件是通过鼠标触发的，此时的事件对象中包含鼠标的相关信息。
>
> 通过鼠标事件对象的属性可以获取鼠标的位置——》从而完成元素跟随鼠标的效果

**需求：给div注册点击事件，获取点击时的鼠标坐标位置**

**记录鼠标位置信息的相关属性：**

- screenX和screenY：光标相对于显示器屏幕左上角的水平和垂直坐标（用的很少）

- clientX和clientY：光标相对于可视区域左上角的水平和垂直坐标

  > 如果有滚动条，不包括被卷去的距离

- pageX和pageY：光标相对于整个网页左上角的水平和垂直坐标（推荐使用）

  > 如果有滚动条，包括卷去的距离

---



##### ヾ(๑╹◡╹)ﾉ" 小天使跟随鼠标移动案例

> 让img图片的left和top值和光标的坐标一致

![小天使跟随案例](mdImg/小天使跟随案例-1593358357857.gif)

**事件拓展：**

- onmousemove：鼠标移动事件

---



### 键盘事件对象的属性

> 有些事件是通过键盘触发的，此时的事件对象中包含键盘的相关信息。
>
> 通过键盘事件对象的属性可以得知用户按下的是什么键——》从而让用户通过键盘控制效果
>
> onkeydown和onkeyup这类键盘事件，一般给文本框或者整个document去注册

**需求：判断用户在input标签中按下的是不是回车？**

> 给input标签注册onkeydown事件，查看键盘事件对象

**记录了键盘码的相关属性**

- e.keyCode：获取按下的键盘码

  > 键盘上的的每一个键都有唯一的数字与之对应

![键盘码](mdImg/keyCode-1593358357858.jpg)

---

##### ヾ(๑╹◡╹)ﾉ" 微博评论-添加回车发布功能

![微博评论-添加回车发布功能](mdImg/微博评论-添加回车发布功能-1593358357858.gif)

- 需要给textarea注册onkeyup事件，判断用户按下的是不是回车
- 如果用户按下的是回车，则触发button的点击事件：直接 `btn.onclick()` 

---

##### 