---
typora-copy-images-to: mdImg
---

# 学习目标

> - [ ] 能够说出offset系列常用的属性
> - [ ] 能够完成拖拽案例
> - [ ] 能够通过事件对象阻止浏览器的默认行为和事件冒泡
> 
> 。。。。。。



**理解上课的知识点......**



# offset系列

> 每一个元素上都有offset系列的相关属性可以访问

## offsetWidth与offsetHeight

**需求：通过js获取页面中某个div的宽高**

**解决：**

- 通过div.style.width获取——》只能拿到行内样式
- 通过div.offsetWidth获取——》没毛病

**作用：**通过offsetWidth和offsetHeight可以直接获取元素的实际大小宽高

**注意点：**

- 获取的是盒子的实际大小

  > content+ padding + border三部分组成

- 获取到的结果是数字类型，可以直接计算

- offsetWidth和offsetHeight是只读属性，不能修改设置

  > 只能看，不能动

---



## offsetParent

> 找到当前元素的最近的有定位的祖先元素

**区别：**

- parentNode：找到的是最近的父元素

- offsetParent：找到的是最近的有定位的父元素

  > 如果父元素中都没有定位，此时就找到body



## offsetLeft与offsetTop

> 用于获取元素的真实位置

- offsetLeft：获取元素距离offsetParent左边的距离
- offsetTop：获取元素距离offsetParent上边的距离

**注意点：**

- 获取的都是距离offsetParent的真实距离
- 获取到的是数值类型，可以直接计算
- offsetLeft和offsetTop同样都是只读类型，不能修改设置

 ![1](./mdImg/11.png)

---



##### ヾ(๑╹◡╹)ﾉ" 拖拽div的案例

> 当鼠标在div上按下时——》让div跟随随鼠标移动
>
> 当鼠标在div上弹起时——》让div不再跟随鼠标移动

![拖拽案例](mdImg/拖拽案例.gif)

- 分别给div注册鼠标按下和弹起事件
- 当鼠标按下后，才开始跟随让——》把移动事件设置在按下事件里面
- 当鼠标弹起时结束跟随——》把移动事件在弹起时移除
- （优化）此时跟随的时候始终都是div左上角跟随鼠标左边，应该让鼠标点击div的点跟随
  - 当鼠标按下时，计算此时鼠标按下点相对于div上和左的偏移值
  - 减少的值应该为点击时 `e.pageY-offsetTop` 即可
  - 减少给div设置的top和left的值即可

##### ------------------------

##### ヾ(๑╹◡╹)ﾉ" 放大镜案例

> 给写好的静态结构添加功能
>
> 先熟悉案例的结构，分析逻辑

![放大镜案例](mdImg/放大镜案例.gif)

- 给小盒子注册鼠标移入事件，当移入后
  - 让大盒子显示
  - 让mask盒子显示
- 给小盒子注册鼠标移出事件，当移出后
  - 让大盒子隐藏
  - 让mask盒子隐藏

---

- 给小盒子注册鼠标移动事件，当小盒子移动时

  - mask会跟着鼠标移动

    > 注意点：offsetLeft和offsetTop获取的是距离最近的有定位的父元素为位置（不一定表示相对于body的距离）

  - 需要让mask的中点与鼠标坐标位置一致，需要mask往左上移动自己宽高的一半

  - 控制mask移动的范围

    > 在给mask设置具体位置前，需要先限定mask的移动范围

- 让大图片在大盒子中等比例移动

  - 是等比例的移动
  - 大图片和mask的移动方向是相反的

  ![mask等比例移动计算图](mdImg/mask等比例移动计算图.png)



---

##### ------------------------

## 事件对象拓展

**事件对象的作用：**

- 鼠标事件拿到鼠标的位置
- 键盘事件拿到按下的键盘码

> 除此之外还有其他作用



### 阻止浏览器默认行为

> 任何事件对象（鼠标事件、键盘事件）都有e.preventDefault()方法，可以用来阻止默认行为
>
> 比如：a标签点击跳转、img按住了可以拖拽、表单点击之后也会跳转，都可以通过以上方法阻止

**需求：给a标签注册点击事件，点击之后弹框** 

> 此时a标签因为默认行为会跳转，所以需要阻止默认行为

**解决方法：**

- `return false;` ：可以，但是之后的代码不会执行（不推荐使用）
- `e.preventDefault()` ：可以，并且之后的代码可以执行（推荐使用）

---

**注意点：针对于addEventListener注册事件的方式，需要使用e.preventDefault()阻止默认行为**

> 其实给a标签设置 `<a href="javascript:void(0)"></a>` 可以阻止a标签的跳转。也只能阻止a标签的跳转。



### 阻止事件冒泡

> 可以通过e.stopPropagation()方法可以阻止事件的下一步传播，常用语阻止事件冒泡

**需求：给father和son分别注册点击事件，需要点击father只触发father的事件，点击son只触发son的事件** 

---



##### ヾ(๑╹◡╹)ﾉ" 弹出登录框案例

<img src="mdImg/弹出登录框案例.gif" alt="弹出登录框案例" style="zoom:80%;" />

- 点击登录按钮，显示登录框
- 点击关闭按钮，隐藏登录框
- 点击document的任意位置，隐藏登录框
  - 此时因为有事件冒泡，所以此时会出问题
    - 点击link部分的时候需要阻止事件冒泡
    - 点击login部分填写内容时也需要阻止事件冒泡

---



### 事件小结

**鼠标事件：**

- onclick：点击事件
- ondblclick：双击事件
- onmousedown：鼠标按下事件
- onmouseup：鼠标弹起事件
- onmouseover：鼠标移入事件
- onmouseout：鼠标移出事件
- onmousemove：鼠标移动事件
- onfocus：获取焦点事件
- onblur：失去焦点事件

**键盘事件：**

- onkeydown：键盘按下事件
- onkeyup：键盘弹起事件

---



